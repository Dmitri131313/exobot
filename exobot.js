require("source-map-support").install();
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("node-uuid"),require("babel-polyfill"),require("eventemitter3"),require("superagent"),require("superagent-promise-plugin"),require("@slack/client"),require("aws-sdk"),require("cryptr"),require("discord.io"),require("events"),require("fs-extra"),require("lowdb"),require("readline"),require("tmi.js"),require("underscore-db"),require("util"),require("lodash"),require("inherits")):"function"==typeof define&&define.amd?define(["node-uuid","babel-polyfill","eventemitter3","superagent","superagent-promise-plugin","@slack/client","aws-sdk","cryptr","discord.io","events","fs-extra","lowdb","readline","tmi.js","underscore-db","util","lodash","inherits"],e):"object"==typeof exports?exports["exobot.js"]=e(require("node-uuid"),require("babel-polyfill"),require("eventemitter3"),require("superagent"),require("superagent-promise-plugin"),require("@slack/client"),require("aws-sdk"),require("cryptr"),require("discord.io"),require("events"),require("fs-extra"),require("lowdb"),require("readline"),require("tmi.js"),require("underscore-db"),require("util"),require("lodash"),require("inherits")):t["exobot.js"]=e(t["node-uuid"],t["babel-polyfill"],t.eventemitter3,t.superagent,t["superagent-promise-plugin"],t["@slack/client"],t["aws-sdk"],t.cryptr,t["discord.io"],t.events,t["fs-extra"],t.lowdb,t.readline,t["tmi.js"],t["underscore-db"],t.util,t.lodash,t.inherits)}(this,function(t,e,n,r,o,i,u,a,s,c,f,l,p,h,d,y,v,b){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=24)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(3),a=n(6),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=/.+/,l=function(t){function e(){r(this,e);var t=o(this,Object.getPrototypeOf(e).call(this));return t.regexp=f,t.respondFunctions=[],t.listenFunctions=[],t}return i(e,t),c(e,[{key:"register",value:function(t){var e=this;this.bot=t,this.botNameRegex=new RegExp("^(?:(?:"+t.name+"|"+t.alias+")[,\\s:.-]*)(.+)"),t.emitter.on("receive-message",function(t){e.respondFunctions.forEach(function(n){return e.process(n[0],n[1],t,!0)}),e.listenFunctions.forEach(function(n){return e.process(n[0],n[1],t)})})}},{key:"process",value:function(t,e,n){var r=this,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(o){var i=this.validateBotName(n);if(!i)return;n=new a.a(s({},n,{text:i,direct:!0}))}t.exec&&(t=this.validate(t));var u=t(n);if(u){var c=e(u,n);if(c)if(c instanceof Promise)c.then(function(t){var e=new a.a(s({},n,{text:t}));r.bot.send(e)});else{var f=new a.a(s({},n,{text:c}));this.bot.send(f)}}}},{key:"validate",value:function(t){return function(e){return t.exec(e.text)}}},{key:"validateBotName",value:function(t){var e=this.botNameRegex.exec(t.text);if(e)return e[1]}},{key:"respond",value:function(t,e){e&&(e=e.bind(this)),this.respondFunctions.push([t,e])}},{key:"listen",value:function(t,e){e&&(e=e.bind(this)),this.listenFunctions.push([t,e])}}]),e}(u.a);e.a=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function i(t){var e=arguments.length<=1||void 0===arguments[1]?t:arguments[1];r(this,i),this.name=t,this.id=e};e.a=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(8),i=o&&o.__esModule?function(){return o["default"]}:function(){return o};n.d(i,"a",i);var u=n(6),a=n(7),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];r(this,t),this.options=e,this.id=e.id||n.i(o.v4)(),this.status=t.STATUS.UNINITIALIZED}return s(t,[{key:"register",value:function(e){if(!e)throw new Error("No bot passed to register; fatal.");this.bot=e,this.status=t.STATUS.CONNECTING,this.listen()}},{key:"listen",value:function(){if(!this.bot)throw new Error("No bot to listen on; fatal.")}},{key:"receive",value:function(t){var e=t.user,n=t.text,r=t.channel,o=t.whisper,i=new u.a({user:e,text:n,channel:r,whisper:o,adapter:this.id});this.bot.emitter.emit("receive-message",i)}},{key:"receiveWhisper",value:function(t){var e=t.user,n=t.text,r=t.channel;n=this.bot.prependNameForWhisper(n),this.receive({user:e,text:n,channel:r,whisper:!0})}},{key:"enter",value:function(t){var e=t.user,n=t.channel,r=new a.a({user:e,channel:n,adapter:this.id,type:a.a.TYPES.ENTER});this.bot.emitter.emit("enter",r)}},{key:"leave",value:function(t){var e=t.user,n=t.channel,r=new a.a({user:e,channel:n,adapter:this.id,type:a.a.TYPES.LEAVE});this.bot.emitter.emit("leave",r)}},{key:"send",value:function(t){console.log(t.text)}},{key:"ping",value:function(){this.pong()}},{key:"pong",value:function(){console.log("Ping received, this.pong() not implemented.")}}]),t}();c.STATUS={UNINITIALIZED:0,CONNECTING:1,CONNECTED:2,DISCONNECTED:3,RECONNECTING:4,ERROR:5},e.a=c},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,t),this.help=void 0,this._requiresDatabase=!1,this.options=e}return i(t,[{key:"register",value:function(t){if(!t)throw new Error("No bot passed to register; fatal.");this.bot=t}},{key:"listen",value:function(){if(!this.bot)throw new Error("No bot to listen on; fatal.")}},{key:"database",value:function(){function t(t,n){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(t,e){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.databaseInitialized();case 2:r=this.bot.db.get(t).value(),"undefined"==typeof r&&this.bot.db.set(t,e).value();case 4:case"end":return n.stop()}},n,this)}));return t}()},{key:"databaseInitialized",value:function(){function t(){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._requiresDatabase=!0,!this._requiresDatabase||!this.bot.db){e.next=3;break}return e.abrupt("return",!0);case 3:return e.abrupt("return",new Promise(function(e){t.bot.emitter.on("dbLoaded",e)}));case 4:case"end":return e.stop()}},n,this)}));return t}()}]),t}();e.a=u},function(t,e,n){"use strict";var r=n(22),o=n(23);for(var i in r)"default"!==i&&function(t){n.d(e,t,function(){return r[t]})}(i);for(var i in o)"default"!==i&&function(t){n.d(e,t,function(){return o[t]})}(i)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(8),i=o&&o.__esModule?function(){return o["default"]}:function(){return o};n.d(i,"a",i);var u=function a(t){var e=t.user,i=t.channel,u=t.adapter,s=t.id,c=void 0===s?n.i(o.v4)():s;r(this,a),this.user=e,this.channel=i,this.adapter=u,this.id=c};e.a=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(5),a=function(t){function e(t){var n=t.text,i=t.whisper,u=void 0===i?!1:i;r(this,e);var a=o(this,Object.getPrototypeOf(e).apply(this,arguments));return a.text=n,a.whisper=u,a}return i(e,t),e}(u.a);e.a=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(5),a=function(t){function e(t){var n=t.type;r(this,e);var i=o(this,Object.getPrototypeOf(e).apply(this,arguments));return i.type=n,i}return i(e,t),e}(u.a);a.TYPES={ENTER:0,LEAVE:1},e.a=a},function(t,e){t.exports=require("node-uuid")},function(t,e,n){"use strict";var r=n(2),o=n(18);n.d(e,"adapters",function(){return i}),n.o(r,"a")&&n.d(e,"Adapter",function(){return r.a});var i=o},function(t,e,n){"use strict";var r=n(5),o=n(7),i=n(6);n.o(r,"a")&&n.d(e,"Message",function(){return r.a}),n.o(o,"a")&&n.d(e,"PresenceMessage",function(){return o.a}),n.o(i,"a")&&n.d(e,"TextMessage",function(){return i.a})},function(t,e,n){"use strict";var r=n(3),o=n(0),i=n(25),u=n(26),a=n(31);n.d(e,"plugins",function(){return s}),n.o(r,"a")&&n.d(e,"Plugin",function(){return r.a}),n.o(o,"a")&&n.d(e,"ChatPlugin",function(){return o.a}),n.o(i,"a")&&n.d(e,"EventPlugin",function(){return i.a}),n.o(u,"a")&&n.d(e,"HTTPPlugin",function(){return u.a});var s=a},function(t,e,n){var r=n(43).format,o=n(37).EventEmitter,i=e=t.exports=function(t,n){"string"==typeof t&&(t=e[t.toUpperCase()]),this.level=t||e.DEBUG,this.stream=n||process.stdout,this.stream.readable&&this.read()};e.EMERGENCY=0,e.ALERT=1,e.CRITICAL=2,e.ERROR=3,e.WARNING=4,e.NOTICE=5,e.INFO=6,e.DEBUG=7,i.prototype={read:function(){var t="",n=this,r=this.stream;r.setEncoding("utf8"),r.on("data",function(r){t+=r,"\n"==t[t.length-1]&&(t.split("\n").map(function(t){if(t.length)try{var r=t.match(/^\[([^\]]+)\] (\w+) (.*)/),o={date:new Date(r[1]),level:e[r[2]],levelString:r[2],msg:r[3]};n.emit("line",o)}catch(i){}}),t="")}),r.on("end",function(){n.emit("end")})},log:function(t,n){if(e[t]<=this.level){var o=r.apply(null,n);this.stream.write("["+new Date+"] "+t+" "+o+"\n")}},emergency:function(t){this.log("EMERGENCY",arguments)},alert:function(t){this.log("ALERT",arguments)},critical:function(t){this.log("CRITICAL",arguments)},error:function(t){this.log("ERROR",arguments)},warning:function(t){this.log("WARNING",arguments)},notice:function(t){this.log("NOTICE",arguments)},info:function(t){this.log("INFO",arguments)},debug:function(t){this.log("DEBUG",arguments)}},i.prototype.__proto__=o.prototype},function(t,e){t.exports=require("babel-polyfill")},function(t,e){t.exports=require("eventemitter3")},function(t,e){t.exports=require("superagent")},function(t,e){t.exports=require("superagent-promise-plugin")},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(36),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a);var s=n(2),c=n(1),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function d(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:d(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},p={ready:"discordReady",message:"discordMessage",presence:"discordPresence",disconnected:"discordDisconnected"},h=function(t){function e(t){var n=t.token,i=t.botId,u=t.username;r(this,e);var a=o(this,Object.getPrototypeOf(e).apply(this,arguments));return a.channels={},a.discordReady=function(){a.status=s.a.STATUS.CONNECTED,a.bot.emitter.emit("connected",a.id),a.bot.log.notice("Connected to Discord."),a.client.setPresence({game:"Exobotting"})},a.discordDisconnected=function(){a.status=s.a.STATUS.DISCONNECTED,a.bot.log.critical("Disconnected from Discord.")},a.botId=i,a.username=u,a.token=n,a}return i(e,t),f(e,[{key:"register",value:function(t){var n=this;l(Object.getPrototypeOf(e.prototype),"register",this).apply(this,arguments);var r=this.token,o=this.botId,i=this.username;return r&&o&&i?(this.client=new a.a.Client({token:r,autorun:!0}),void Object.keys(p).forEach(function(t){var e=n[p[t]];n.client.on(t,function(){return e.bind(n).apply(void 0,arguments)}),n.client.on(t,function(){for(var e,r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];(e=n.bot.emitter).emit.apply(e,["discord-"+t].concat(o))})})):(this.status=s.a.STATUS.ERROR,void t.log.error("token, botId, and username are required to connect to discord."))}},{key:"send",value:function(t){this.bot.log.debug("Sending "+t.text+" to "+t.channel),this.client.sendMessage({to:t.channel,message:t.text})}},{key:"discordMessage",value:function(t,n,r,o){if(t!==this.username){var i=new c.a(t,n);return this.client.directMessages[r]?l(Object.getPrototypeOf(e.prototype),"receiveWhisper",this).call(this,{user:i,text:o,channel:r}):void this.receive({user:i,text:o,channel:r})}}},{key:"discordPresence",value:function(t,n,r,o,i){if(n!==this.botId){var u=new c.a(t,n);if("online"===r)return l(Object.getPrototypeOf(e.prototype),"enter",this).call(this,{user:u,channel:i.d.channel_id});if("offline"===r)return l(Object.getPrototypeOf(e.prototype),"leave",this).call(this,{user:u,channel:i.d.channel_id})}}}]),e}(s.a);e.a=h},function(t,e,n){"use strict";var r=n(19),o=n(17),i=n(21),u=n(20);n.o(r,"a")&&n.d(e,"Shell",function(){return r.a}),n.o(o,"a")&&n.d(e,"Discord",function(){return o.a}),n.o(i,"a")&&n.d(e,"Twitch",function(){return i.a}),n.o(u,"a")&&n.d(e,"Slack",function(){return u.a})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(40),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a);var s=n(2),c=n(1),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function v(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:v(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},p="SHELL",h=new c.a("shell"),d=["exit","quit","q"],y=function(t){function e(){r(this,e);var t=o(this,Object.getPrototypeOf(e).call(this));return t.rl=a.a.createInterface({input:process.stdin,output:process.stdout}),t}return i(e,t),f(e,[{key:"prompt",value:function(){var t=this;this.rl.question("Chat: ",function(n){return d.includes(n)?process.exit():(l(Object.getPrototypeOf(e.prototype),"receive",t).call(t,{text:n,channel:p,user:h}),void t.prompt())})}},{key:"register",value:function(t){l(Object.getPrototypeOf(e.prototype),"register",this).call(this,t),this.prompt(),this.status=s.a.STATUS.CONNECTED}}]),e}(s.a);e.a=y},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=n(33),s=a&&a.__esModule?function(){return a["default"]}:function(){return a};n.d(s,"a",s);var c=n(57),f=c&&c.__esModule?function(){return c["default"]}:function(){return c};n.d(f,"a",f);var l,p=n(2),h=n(1),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),y=function w(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:w(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},v=(new f.a.DM)._modelName,b=(l={},u(l,a.CLIENT_EVENTS.RTM.CONNECTING,"slackConnecting"),u(l,a.CLIENT_EVENTS.RTM.RTM_CONNECTION_OPENED,"slackConnected"),u(l,a.CLIENT_EVENTS.RTM.AUTHENTICATED,"slackAuthenticated"),u(l,a.CLIENT_EVENTS.RTM.DISCONNECT,"slackDisconnected"),u(l,a.CLIENT_EVENTS.RTM.UNABLE_TO_RTM_START,"slackUnableToStart"),u(l,a.CLIENT_EVENTS.RTM.ATTEMPTING_RECONNECT,"slackReconnecting"),u(l,a.RTM_EVENTS.MESSAGE,"slackMessage"),l),g=function(t){function e(t){var n=t.token;r(this,e);var i=o(this,Object.getPrototypeOf(e).apply(this,arguments));return i.slackConnecting=function(){i.bot.log.info("Connecting to Slack."),i.status=p.a.STATUS.CONNECTING},i.slackConnected=function(){i.bot.log.info("Connected to Slack.")},i.slackAuthenticated=function(){i.bot.log.notice("Successfully authenticated to Slack."),i.status=p.a.STATUS.CONNECTED},i.slackDisconnected=function(){i.bot.log.critical("Disconnected from Slack."),i.status=p.a.STATUS.DISCONNECTED},i.slackUnableToStart=function(){i.bot.log.critical("Unable to start Slack."),i.status=p.a.STATUS.DISCONNECTED},i.slackReconnecting=function(){i.bot.log.notice("Reconnecting to Slack."),i.status=p.a.STATUS.RECONNECTING},i.slackMessage=function(t){var e=i.client.activeUserId;if(t.user!==e){var n=i.client.dataStore.getUserById(t.user),r=void 0;r=n?new h.a(n.name,n.id):new h.a(t.user);var o=i.client.dataStore.getChannelGroupOrDMById(t.channel);return o&&o._modelName===v?i.receiveWhisper({user:r,text:t.text,channel:t.channel}):void i.receive({user:r,text:t.text,channel:t.channel})}},i.token=n,i}return i(e,t),d(e,[{key:"register",value:function(t){var n=this;y(Object.getPrototypeOf(e.prototype),"register",this).apply(this,arguments);var r=this.token;this.client=new a.RtmClient(r,{logLevel:t.logLevel}),Object.keys(b).forEach(function(e){var r=n[b[e]];n.client.on(e,function(){return r.apply(void 0,arguments)}),n.client.on(e,function(){for(var n,r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];(n=t.emitter).emit.apply(n,["slack-"+e].concat(o))})}),this.client.start()}},{key:"send",value:function(t){this.bot.log.debug("Sending "+t.text+" to "+t.channel),this.client.sendMessage(t.text,t.channel)}}]),e}(p.a);e.a=g},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(41),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a);var s=n(2),c=n(1),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function y(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:y(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},p={connecting:"twitchConnecting",connected:"twitchConnected",logon:"twitchLogon",disconnected:"twitchDisconnected",reconnect:"twitchReconnect",chat:"twitchChat",emoteonly:"twitchEmoteonly",join:"twitchJoin",part:"twitchPart",mods:"twitchMods",notice:"twitchNotice",ping:"twitchPing",pong:"twitchPong",roomstate:"twitchRoomstate",slowmode:"twitchSlowmode",subscribers:"twitchSubscribers",subscription:"twitchSubscription",timeout:"twitchTimeout",whisper:"twitchWhisper"},h=function(t){function e(t){var n=t.username,i=t.oauthPassword,u=t.channels,a=void 0===u?[]:u;r(this,e);var s=o(this,Object.getPrototypeOf(e).apply(this,arguments));return d.call(s),s.username=n,s.oauthPassword=i,s.channels=a,s}return i(e,t),f(e,[{key:"register",value:function(t){var n=this;l(Object.getPrototypeOf(e.prototype),"register",this).apply(this,arguments);var r=this.username,o=this.oauthPassword,i=this.channels;return r&&o?(i.length||t.log.critical("No channels passed to Twitch adapter to connect to."),this.client=new a.a.client({channels:i,identity:{username:r,password:o},options:{debug:!0},secure:!0,reconnect:!0,logger:{info:t.log.info.bind(t.log),warn:t.log.warning.bind(t.log),error:t.log.error.bind(t.log)},connection:{cluster:"aws"}}),this.client.connect(),void Object.keys(p).forEach(function(t){var e=n[p[t]];n.client.on(t,function(){return e.apply(void 0,arguments)}),n.client.on(t,function(){for(var e,r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];(e=n.bot.emitter).emit.apply(e,["twitch-"+t].concat(o))})})):void t.log.error("username and oauthPassword are required to connect to Twitch.")}},{key:"send",value:function(t){return this.bot.log.debug("Sending "+t.text+" to "+t.channel),t.whisper?this.client.whisper(t.user.name,t.text):void this.client.say(t.channel,t.text)}}]),e}(s.a),d=function(){var t=this;this.twitchConnecting=function(){t.status=s.a.STATUS.CONNECTING},this.twitchConnected=function(){t.status=s.a.STATUS.CONNECTED,t.bot.emitter.emit("connected",t.id),t.bot.log.notice("Connected to Twitch.")},this.twitchLogon=function(){t.status=s.a.STATUS.CONNECTED,t.bot.log.notice("Successfully logged on to Twitch.")},this.twitchDisconnected=function(){t.status=s.a.STATUS.DISCONNECTED,t.bot.log.warning("Disconnected from Twitch.")},this.twitchReconnect=function(){t.status=s.a.STATUS.RECONNECTING,t.bot.log.notice("Reconnecting to Twitch.")},this.twitchChat=function(e,n,r){if(n.username!==t.username){var o=new c.a(n.username);t.receive({user:o,text:r,channel:e})}},this.twitchEmoteonly=function(){},this.twitchJoin=function(e,n){if(n===t.username){var r=new c.a(n);return t.enter({user:r,channel:e})}},this.twitchPart=function(e,n){if(n===t.username){var r=new c.a(n);return t.leave({user:r,channel:e})}},this.twitchPing=function(){t.ping()},this.twitchWhisper=function(e,n){if(e.username!==t.username){var r=new c.a(e.username);t.receiveWhisper({user:r,text:n,channel:e.username})}},this.twitchPong=function(){},this.twitchRoomstate=function(){},this.twitchSlowmode=function(){},this.twitchSubscribers=function(){},this.twitchSubscription=function(){},this.twitchTimeout=function(){},this.twitchMods=function(){},this.twitchNotice=function(){}};e.a=h},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}var o=n(35),i=o&&o.__esModule?function(){return o["default"]}:function(){return o};n.d(i,"a",i);var u=n(39),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a);var s=n(38),c=s&&s.__esModule?function(){return s["default"]}:function(){return s};n.d(c,"a",c);var f=n(42),l=f&&f.__esModule?function(){return f["default"]}:function(){return f};n.d(l,"a",l),n.d(e,"deserialize",function(){return p}),n.d(e,"serialize",function(){return h}),n.d(e,"read",function(){return d}),n.d(e,"write",function(){return y}),n.d(e,"readLocal",function(){return v}),n.d(e,"writeLocal",function(){return b}),n.d(e,"DB",function(){return g});var p=function(t){return function(e){if(!e)return{};var n=t.decrypt(e),r=JSON.parse(n);return r}},h=function(t){return function(e){var n=JSON.stringify(e),r=t.encrypt(n);return r}},d=function(t){return function(e,n){return new Promise(function(r,o){t(e).then(function(t){try{r(n(t))}catch(e){o(e)}})})}},y=function(t){return function(e,n,r){return new Promise(function(o,i){try{var u=r(n);t(e,u).then(o,i)}catch(a){i(a)}})}},v=function(t){return new Promise(function(e,n){c.a.ensureFile(t,function(r){return r?n(r):void c.a.readFile(t,"utf8",function(t,r){return t?n(t):e(r)})})})},b=function(t,e){return new Promise(function(n,r){c.a.ensureFile(t,function(o){return o?r(o):void c.a.writeFile(t,e,"utf8",function(t){return t?r(t):n(e)})})})},g=function(){var t=r(regeneratorRuntime.mark(function e(t){var n,r,o,u=t.path,s=t.key,c=t.readFile,f=void 0===c?v:c,g=t.writeFile,w=void 0===g?b:g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new i.a(s||name),r=u||"./data/"+name+".json",t.next=4,new a.a(r,{storage:{read:d(f),write:y(w)},format:{deserialize:p(n),serialize:h(n)}});case 4:return o=t.sent,o._.mixin(l.a),t.abrupt("return",o);case 7:case"end":return t.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function o(t,e,n,o){var i=arguments.length<=4||void 0===arguments[4]?!1:arguments[4];return function(){var u=r(regeneratorRuntime.mark(function f(r){var u,l=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.delegateYield(regeneratorRuntime.mark(function p(){var u;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!i){s.next=3;break}return s.next=3,c(t,e,n,o);case 3:return u=new a.a.S3({region:t,accessKeyId:e,secretAccessKey:n,params:{Bucket:o}}),s.abrupt("return",{v:new Promise(function(t,e){u.getObject({Bucket:o,Key:r},function(n,r){return n&&404===n.statusCode?t(""):n?e(n):t(r.Body.toString())})})});case 5:case"end":return s.stop()}},p,l)})(),"t0",2);case 2:if(u=f.t0,"object"!==("undefined"==typeof u?"undefined":s(u))){f.next=5;break}return f.abrupt("return",u.v);case 5:f.next=10;break;case 7:f.prev=7,f.t1=f["catch"](0),console.log(f.t1);case 10:case"end":return f.stop()}},f,this,[[0,7]])}));return function(t){return u.apply(this,arguments)}}()}function i(t,e,n,o){var i=arguments.length<=4||void 0===arguments[4]?!1:arguments[4];return function(){var u=r(regeneratorRuntime.mark(function f(r,u){var l,p=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.delegateYield(regeneratorRuntime.mark(function h(){var s;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!i){f.next=3;break}return f.next=3,c(t,e,n,o);case 3:return s=new a.a.S3({region:t,accessKeyId:e,secretAccessKey:n,params:{Bucket:o,Key:r}}),f.abrupt("return",{v:new Promise(function(t,e){s.upload({Body:u},function(n,r){return n?e(n):void t(r)})})});case 5:case"end":return f.stop()}},h,p)})(),"t0",2);case 2:if(l=f.t0,"object"!==("undefined"==typeof l?"undefined":s(l))){f.next=5;break}return f.abrupt("return",l.v);case 5:f.next=10;break;case 7:f.prev=7,f.t1=f["catch"](0),console.log(f.t1);case 10:case"end":return f.stop()}},f,this,[[0,7]])}));return function(t,e){return u.apply(this,arguments)}}()}var u=n(34),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a),e.readS3=o,e.writeS3=i,n.d(e,"createS3Bucket",function(){return c});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},c=function(){var t=r(regeneratorRuntime.mark(function e(t,n,r,o){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=function(){var e=new a.a.S3({region:t,accessKeyId:n,secretAccessKey:r,params:{Bucket:o}});return{v:new Promise(function(t){return e.createBucket(t)})}}(),"object"!==("undefined"==typeof i?"undefined":s(i))){e.next=4;break}return e.abrupt("return",i.v);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.log(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(e,n,r,o){return t.apply(this,arguments)}}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(13),i=o&&o.__esModule?function(){return o["default"]}:function(){return o};n.d(i,"a",i);var u=n(14),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(a,"a",a);var s=n(12),c=s&&s.__esModule?function(){return s["default"]}:function(){return s};n.d(c,"a",c);var f=n(15),l=f&&f.__esModule?function(){return f["default"]}:function(){
return f};n.d(l,"a",l);var p=n(16),h=p&&p.__esModule?function(){return p["default"]}:function(){return p};n.d(h,"a",h);var d=n(4),y=n(9),v=n(10),b=n(11),g=n(1);n.d(e,"Exobot",function(){return E});for(var w in y)["Exobot","User","default"].indexOf(w)<0&&function(t){n.d(e,t,function(){return y[t]})}(w);for(var w in v)["Exobot","User","default"].indexOf(w)<0&&function(t){n.d(e,t,function(){return v[t]})}(w);for(var w in b)["Exobot","User","default"].indexOf(w)<0&&function(t){n.d(e,t,function(){return b[t]})}(w);for(var w in d)["Exobot","User","default"].indexOf(w)<0&&function(t){n.d(e,t,function(){return d[t]})}(w);n.o(g,"a")&&n.d(e,"User",function(){return g.a});var m=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();h.a.Promise=Promise;var O=h.a.patch(l.a),E=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t),x.call(this),this.name=e,this.alias=n.alias,this.emitter=new a.a,this.http=O,this.initLog(n.logLevel||c.a.WARNING),this.initAdapters(n.adapters),this.initPlugins(n.plugins);var o=n.dbPath||"./data/"+e+".json";this.initDB(n.key,o,n.readFile,n.writeFile)}return m(t,[{key:"addPlugin",value:function(t){t.register(this),this.plugins.push(t)}},{key:"addAdapter",value:function(t){t.register(this),this.adapters[t.id]=t}},{key:"prependNameForWhisper",value:function(t){return t.slice(0,this.name.length).toLowerCase()!==this.name.toLowerCase()&&t.slice(0,this.alias.length).toLowerCase()!==this.alias.toLowerCase()&&(t=this.name+" "+t),t}},{key:"send",value:function(t){var e=this.adapters[t.adapter];return e?void e.send(t):void this.bot.log.warning("Message sent with invalid adapter: "+t.adapter)}}]),t}(),x=function(){var t=this;this.plugins=[],this.adapters={},this.initAdapters=function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];e.forEach(function(e){return t.addAdapter(e)})},this.initPlugins=function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];e.forEach(function(e){return t.addPlugin(e)})},this.initLog=function(e){var n=new c.a(e||c.a.WARNING);t.log=n,t.logLevel=e,e===c.a.DEBUG&&setInterval(t.logProcess,1e4)},this.initDB=function(e,r,o,i){return e?void n.i(d.DB)({key:e,readFile:o,writeFile:i,path:r,emitter:t.emitter}).then(function(e){t.db=e,t.emitter.emit("dbLoaded",e)},t.log.critical):void t.log.critical("Pass options.key in to bot initializer. Database not initializing.")},this.logProcess=function(){t.log.debug(process.memoryUsage(),process.cpuUsage())}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(3),a=function(t){function e(){return r(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),e}(u.a);e.a=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(3),a=function(t){function e(){return r(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),e}(u.a);e.a=a},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(0),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t){function e(){o(this,e);var t=i(this,Object.getPrototypeOf(e).apply(this,arguments));return t.help='dbdump: dump the database. Say "<botname> dbdump".',t.respond(/^db dump/i,t.dump),t.respond(/^db clear/i,t.clear),t}return u(e,t),s(e,[{key:"dump",value:function(){function t(){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.databaseInitialized();case 2:return t.abrupt("return",this.bot.db.getState());case 3:case"end":return t.stop()}},n,this)}));return t}()},{key:"clear",value:function(){function t(){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.databaseInitialized();case 2:this.bot.log.critical("Database clearing. You may need to restart your bot."),this.bot.db.setState(),this.bot.initializePlugins();case 5:case"end":return t.stop()}},n,this)}));return t}()}]),e}(a.a);e.a=c},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(0),s=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function h(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:h(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l="http://api.giphy.com/v1/gifs/search",p=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e);var n=t.apiKey,r=i(this,Object.getPrototypeOf(e).apply(this,arguments));return r.help='Help: Explains commands. Say "<botname> help" for information.',r.respond(/^(?:gif|giphy)(?:\sme)?\s+(.*)/i,r.giphy),r.apiKey=n,r}return u(e,t),c(e,[{key:"register",value:function(t){f(Object.getPrototypeOf(e.prototype),"register",this).apply(this,arguments),this.apiKey||t.log.critical("No apiKey passed to Giphy plugin; plugin will not work.")}},{key:"giphy",value:function(){function t(t){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(t){var e,r,o,i=s(t,2),u=i[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.bot.http.get(l).query({q:u,api_key:this.apiKey});case 3:if(e=t.sent,r=e.body,o=r.data,!o.length){t.next=8;break}return t.abrupt("return",o[parseInt(Math.random()*o.length)].images.original.url);case 8:t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),this.bot.log.notice("Error returned from Giphy request."),this.bot.log.debug(t.t0);case 14:case"end":return t.stop()}},n,this,[[0,10]])}));return t}()}]),e}(a.a);e.a=p},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(0),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function h(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:h(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=["hi","hello","sup","greetings","yo","hey"],f=["goodbye","farwell","bye","later","see ya","cya"],l=function(t,e){return new RegExp("^("+e.join("|")+")[,\\s]*"+t,"i")},p=function(t){function e(){var t,n,i,u;r(this,e);for(var a=arguments.length,s=Array(a),c=0;a>c;c++)s[c]=arguments[c];return n=i=o(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(s))),i.help='Greetings: says "hi" back. Say "hi <botname>" for a response.',u=n,o(i,u)}return i(e,t),a(e,[{key:"register",value:function(t){s(Object.getPrototypeOf(e.prototype),"register",this).apply(this,arguments),this.listen(l(t.name,c),this.greeting),this.listen(function(t){return c.includes(t.text.toLowerCase())},this.greeting),this.respond(function(t){return c.includes(t.text.toLowerCase())},this.greeting),this.listen(l(t.name,f),this.farewell),this.listen(function(t){return f.includes(t.text.toLowerCase())},this.farewell),this.respond(function(t){return f.includes(t.text.toLowerCase())},this.farewell)}},{key:"greeting",value:function(t,e){var n=c[parseInt(Math.random()*c.length)];return n+", "+e.user.name+"!"}},{key:"farewell",value:function(t,e){var n=f[parseInt(Math.random()*f.length)];return n+", "+e.user.name+"!"}}]),e}(u.a);e.a=p},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=n(0),a=function(t){function e(){r(this,e);var t=o(this,Object.getPrototypeOf(e).apply(this,arguments));return t.help='Help: Explains commands. Say "<botname> help" for information.',t.pluginHelp=function(){return t.bot.plugins.filter(function(t){return t.help}).map(function(t){return t.help},[]).join("\n")},t.respond(/^help$/i,t.pluginHelp),t}return i(e,t),e}(u.a);e.a=a},function(t,e,n){"use strict";var r=n(29),o=n(30),i=n(32),u=n(27),a=n(28);n.o(r,"a")&&n.d(e,"Greetings",function(){return r.a}),n.o(o,"a")&&n.d(e,"Help",function(){return o.a}),n.o(i,"a")&&n.d(e,"Points",function(){return i.a}),n.o(u,"a")&&n.d(e,"DBDump",function(){return u.a}),n.o(a,"a")&&n.d(e,"Giphy",function(){return a.a})},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),a=u.value}catch(s){return void n(s)}return u.done?void t(a):Promise.resolve(a).then(function(t){return r("next",t)},function(t){return r("throw",t)})}return r("next")})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(0),s=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function h(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:h(o,e,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=function(t){return t.replace(/[^\w]/g,"")},p=function(t){function e(){o(this,e);var t=i(this,Object.getPrototypeOf(e).apply(this,arguments));return t.help=["Points: add points to things. `thing++` or `thing--` adds or removes","points. Users are rate-limited from voting on the same thing multiple","times. Optionally add reasons: `thing++ for my reasons`."].join(" "),t.listen(/^([\s\w'@.\-:]*)\s*\+\+(?:\s+for (.*))?$/i,function(e){return t.changePoints(e,1)}),t.listen(/^([\s\w'@.\-:]*)\s*\-\-(?:\s+for (.*))?$/i,function(e){return t.changePoints(e,-1)}),t.respond(/^tops?\s*(\d*)?$/i,t.tops),t.respond(/^score(?: for)?(.*)$/i,t.score),t}return u(e,t),c(e,[{key:"register",value:function(t){f(Object.getPrototypeOf(e.prototype),"register",this).call(this,t),this.database("points",{things:{},tops:[]})}},{key:"changePoints",value:function(){function t(t,n){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(t,e){var r,o,i,u,a=s(t,3),c=(a[0],a[1]),f=a[2];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=c.trim(),r=l(c),t.next=4,this.databaseInitialized();case 4:return o=this.bot.db.get("points.things."+r).value(),o||(o=this.buildPoints(c,r)),o.points=o.points+e,f&&(i=l(f),u=o.reasons[i]||{score:0,reason:f},u.score++,o.reasons[i]=u),this.bot.db.set("points.things."+r,o).value(),this.bot.db.write(),this.updateTops(),t.abrupt("return",c+" has "+o.points+" points.");case 12:case"end":return t.stop()}},n,this)}));return t}()},{key:"tops",value:function(){function t(t){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(t){var e,r,o,i=s(t,2),u=(i[0],i[1]),a=void 0===u?10:u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.databaseInitialized();case 2:return a>25&&(a=25),e=this.bot.db.get("points.things").value(),r=this.bot.db.get("points.tops").slice(0,a).value(),o=["Top "+Math.min(a,r.length)+":"],r.forEach(function(t){return o.push(e[t].name+": "+e[t].points)}),t.abrupt("return",o.join("\n"));case 8:case"end":return t.stop()}},n,this)}));return t}()},{key:"score",value:function(){function t(t){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(t){var e,r,o,i,u,a=s(t,2),c=(a[0],a[1]);return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=c.trim(),e=l(c),t.next=4,this.databaseInitialized();case 4:return r=this.bot.db.get("points.things."+e).value(),o=r.reasons,i=[c+" has "+r.points+" points."],u=Object.keys(r.reasons),u.length>0&&(i.push("Here are some reasons:"),u.forEach(function(t){i.push(o[t].reason+": "+o[t].score+" points")})),t.abrupt("return",i.join("\n"));case 10:case"end":return t.stop()}},n,this)}));return t}()},{key:"updateTops",value:function(){function t(){return e.apply(this,arguments)}var e=r(regeneratorRuntime.mark(function n(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.databaseInitialized();case 2:t=this.bot.db.get("points.things").orderBy("points","desc").map("id").value(),this.bot.db.set("points.tops",t).value(),this.bot.db.write();case 5:case"end":return e.stop()}},n,this)}));return t}()},{key:"buildPoints",value:function(t,e){return{name:t,id:e,points:0,reasons:{}}}}]),e}(a.a);e.a=p},function(t,e){t.exports=require("@slack/client")},function(t,e){t.exports=require("aws-sdk")},function(t,e){t.exports=require("cryptr")},function(t,e){t.exports=require("discord.io")},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("fs-extra")},function(t,e){t.exports=require("lowdb")},function(t,e){t.exports=require("readline")},function(t,e){t.exports=require("tmi.js")},function(t,e){t.exports=require("underscore-db")},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("lodash")},function(t,e){t.exports=require("inherits")},function(t,e,n){function r(t,e){this._properties={},this._modelName=t,this._setProperties(a(e)?{}:e)}var o=n(44).forEach,i=n(44).has,u=n(44).isArray,a=n(44).isEmpty,s=n(44).isObject,c=n(44).map,f=n(44).mapValues,l=n(58),p=n(56);r.prototype.update=function(t){return this._setProperties(t),this},r.prototype._setProperties=function(t){o(t,this._setModelProperty,this)},r.prototype._setModelProperty=function(t,e){s(t)?this._setObjectProperty(e,t):u(t)?this._setArrayProperty(e,t):(this._properties[e]=l.SIMPLE,this[e]=t)},r.prototype._setObjectProperty=function(t,e){var n,r=i(this,t);p.isModelObj(e)?(r?this[t].update(e):(n=p.getModelClass(),this[t]=new n(e)),this._properties[t]=l.MODEL):(this._properties[t]=l.SIMPLE,this[t]=e)},r.prototype._setArrayProperty=function(t,e){var n,r;a(e)?(this._properties[t]=l.SIMPLE,this[t]=e):(r=e[0],p.isModelObj(r)?(n=p.getModelClass(),this[t]=c(e,function(t){return new n(t)}),this._properties[t]=l.MODEL_ARRAY):(this._properties[t]=l.SIMPLE,this[t]=e))},r.prototype.toJSON=function(){var t=f(this._properties,function(t,e){var n;return n=t===l.MODEL?this[e].toJSON():t===l.MODEL_ARRAY?c(this[e],function(t){return t.toJSON()}):this[e]},this);return t},t.exports=r},function(t,e,n){var r=n(45),o=n(48),i=function(t,e){o.call(this,t,e)};r(i,o),t.exports=i},function(t,e,n){function r(t,e){this.history=[],this._typing={},this.unreadCount=0,this.lastRead="0000000000.000000",this._maxTs="0000000000.000000",f.call(this,t,e)}var o=n(44).bind,i=n(44).forEachRight,u=n(44).find,a=n(44).findLastIndex,s=n(45),c=n(44).keys,f=n(46);s(r,f),r.prototype.USER_TYPING_TIMEOUT=5e3,r.prototype._setProperties=function(t){r.super_.prototype._setProperties.call(this,t),this.latest&&this.addMessage(this.latest)},r.prototype.startedTyping=function(t){this._typing[t]&&clearTimeout(this._typing[t]),this._typing[t]=setTimeout(o(function(){delete this._typing[t]},this),this.USER_TYPING_TIMEOUT)},r.prototype.recalcUnreads=function(){var t=!0;return this.unreadCount=0,i(this.history,function(e){return e.ts>this.lastRead?this.unreadCount++:t=!1,t},this),this.unreadCount},r.prototype.getType=function(){return this._modelName.toLowerCase()},r.prototype.getTypingUsers=function(){return c(this._typing)},r.prototype.getMessageByTs=function(t){return u(this.history,{ts:t})},r.prototype.addMessage=function(t){this.history.push(t),t.ts>this._maxTs&&!t.hidden&&(this._maxTs=t.ts,this.unreadCount++)},r.prototype.updateMessage=function(t){var e=t.message,n=a(this.history,"ts",e.ts);-1!==n&&(this.history[n]=e)},t.exports=r},function(t,e,n){var r=n(45),o=n(47),i=function(t){o.call(this,"Channel",t)};r(i,o),t.exports=i},function(t,e,n){function r(t){i.call(this,"DM",t)}var o=n(45),i=n(48);o(r,i),t.exports=r},function(t,e,n){function r(t){i.call(this,"File",t)}var o=n(45),i=n(46);o(r,i),t.exports=r},function(t,e,n){function r(t){i.call(this,"Group",t)}var o=n(45),i=n(47);o(r,i),t.exports=r},function(t,e,n){function r(t){i.call(this,"MPDM",t)}var o=n(45),i=n(47);o(r,i),t.exports=r},function(t,e,n){function r(t){i.call(this,"UserGroup",t)}var o=n(45),i=n(46);o(r,i),t.exports=r},function(t,e,n){function r(t){i.call(this,"User",t)}var o=n(45),i=n(46);o(r,i),t.exports=r},function(t,e,n){var r=n(44).has,o=["C","F","G","D","U","S"],i=function(t){return r(t,"id")?-1!==o.indexOf(t.id.substr(0,1)):!1},u=function(t){var e,r=t.id.substr(0,1);return"C"===r?e=n(49):"F"===r?e=n(51):"D"===r?e=n(50):"U"===r?e=n(55):"S"===r?e=n(54):"G"===r&&(t.is_mpim&&(e=n(53)),t.is_group&&(e=n(52))),e};t.exports.isModelObj=i,t.exports.getModelClass=u},function(t,e,n){t.exports={Channel:n(49),DM:n(50),File:n(51),Group:n(52),MPDM:n(53),User:n(55),UserGroup:n(54)}},function(t,e){var n={SIMPLE:0,MODEL:1,MODEL_ARRAY:2};t.exports=n}])});
//# sourceMappingURL=exobot.js.map